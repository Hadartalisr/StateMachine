implementation of a state machine

TODOS:
- change all the prints to a generic logger


